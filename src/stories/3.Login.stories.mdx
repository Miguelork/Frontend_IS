import { Meta } from '@storybook/addon-docs';
import Code from './assets/code-brackets.svg';
import Colors from './assets/colors.svg';
import Comments from './assets/comments.svg';
import Direction from './assets/direction.svg';
import Flow from './assets/flow.svg';
import Plugin from './assets/plugin.svg';
import Repo from './assets/repo.svg';
import StackAlt from './assets/stackalt.svg';

<Meta title="Login" />

<style>{`
  .subheading {
    --mediumdark: '#999999';
    font-weight: 900;
    font-size: 13px;
    color: #999;
    letter-spacing: 6px;
    line-height: 24px;
    text-transform: uppercase;
    margin-bottom: 12px;
    margin-top: 40px;
  }

  .link-list {
    display: grid;
    grid-template-columns: 1fr;
    grid-template-rows: 1fr 1fr;
    row-gap: 10px;
  }

  @media (min-width: 620px) {
    .link-list {
      row-gap: 20px;
      column-gap: 20px;
      grid-template-columns: 1fr 1fr;
    }
  }

  @media all and (-ms-high-contrast:none) {
  .link-list {
      display: -ms-grid;
      -ms-grid-columns: 1fr 1fr;
      -ms-grid-rows: 1fr 1fr;
    }
  }

  .link-item {
    display: block;
    padding: 20px 30px 20px 15px;
    border: 1px solid #00000010;
    border-radius: 5px;
    transition: background 150ms ease-out, border 150ms ease-out, transform 150ms ease-out;
    color: #333333;
    display: flex;
    align-items: flex-start;
  }

  .link-item:hover {
    border-color: #1EA7FD50;
    transform: translate3d(0, -3px, 0);
    box-shadow: rgba(0, 0, 0, 0.08) 0 3px 10px 0;
  }

  .link-item:active {
    border-color: #1EA7FD;
    transform: translate3d(0, 0, 0);
  }

  .link-item strong {
    font-weight: 700;
    display: block;
    margin-bottom: 2px;
  }
  
  .link-item img {
    height: 40px;
    width: 40px;
    margin-right: 15px;
    flex: none;
  }

  .link-item span {
    font-size: 14px;
    line-height: 20px;
  }

  .tip {
    display: inline-block;
    border-radius: 1em;
    font-size: 11px;
    line-height: 12px;
    font-weight: 700;
    background: #E7FDD8;
    color: #66BF3C;
    padding: 4px 12px;
    margin-right: 10px;
    vertical-align: top;
  }

  .tip-wrapper {
    font-size: 13px;
    line-height: 20px;
    margin-top: 40px;
    margin-bottom: 40px;
  }

  .tip-wrapper code {
    font-size: 12px;
    display: inline-block;
  }

  
`}</style>

# Login

El login esta compuesto por un titulo y una imagen que se encuentran en la secion de titulo con su respectiva clase. Además, muestra la imagen localizada en `assets/img/log.svg`

    <div className="section-title" data-aos="fade-up">
       <h2>Inicio de Sesión</h2>
       <p style={{ "color": "white" }}>Usuario</p>
    </div>
    <div className="mt-0 mb-4 hero-img" id="imagen" data-aos="zoom-out" data-aos-delay={100}>
       <img src="assets/img/log.svg" className="img-fluid" alt="" />
    </div>


Seguidamente, se encuentran los inputs que son utilizados para que el usuario pueda escribir sus datos de ingreso a la plataforma.

     <input type="text" id="user" name="user" onClick={validarFormulario} onBlur={validarFormulario} onKeyUp={validarFormulario} className="form-control" placeholder="Escriba su usuario" />

    <input type="password" id="password" name="password" onClick={validarFormulario} onBlur={validarFormulario} onKeyUp={validarFormulario} className="form-control" placeholder="Escriba su contraseña" />

Por ultimo, tiene un botón que sirve de submit para llamar a la funcion correspondite que realiza la comprobación de los datos para saber si el usuario existe permitirle el acceso.

      <a href="#" onClick={onSubmit} className="btn-get-started scrollto">Aceptar</a>

La función `onSubmit` comprueba si los campos estan llenos con datos y, posteriormente, se procede a llamar a la funcion `login` que es la encargada de realizar la comprobacion de los datos con la DB.

    async function login() {
        ocultar('login');
        ocultar('imagen');
        mostrar('cargando');
        // Funcion para iniciar sesión
        const response = await axios({
            url: "https://dblinkmed.herokuapp.com/listaUsuario",
            method: "GET",
        });
        var login = false; // Variable de control para poner en true si coinciden los datos con la DB
    
        response.data.item.map((usuario) => {
            if (usuario.user == document.getElementById("user").value && usuario.password == document.getElementById("password").value) {
                login = true;
                cookies.set('usuario', usuario, { path: "/" });
            }
        });
        // Si login esta true es que todo fue bien y se inicia sesión
        if (login == true) {
    
            //Llamamos a la lista de historias para verificar si hay una historia para este usuario
            const check = await axios({
                url: "https://dblinkmed.herokuapp.com/listaHistoria",
                method: "GET",
            });
    
            var hayHistoria = false;//variable de control que se pone true si existe una historia para el usuario
            check.data.item.map((historia) => {
                if (cookies.get("usuario").tipo == 'Paciente'
                    && historia.usuario_id == cookies.get("usuario")._id) {
                    hayHistoria = true;
                }
            });
    
            //Si el usuario es de tipo paciente y no se encuentra una historia en bdd se le crea una
            if (hayHistoria == false && cookies.get("usuario").tipo == 'Paciente') {
                axios.post("https://dblinkmed.herokuapp.com/crearHistoria", {
                    usuario_id: cookies.get("usuario")._id,
                    contenido: "",
                })
                    .then(function (response) {
                        // console.log(response);
                    })
                    .catch(function (error) {
                        // console.log(error);
                    });
            }
    
            setTimeout(() => {
                window.location.href = "/menu";
            }, 1000);
        } else {
            setTimeout(() => {
                ocultar('cargando');
                mostrar('login');
                mostrar('imagen');
                mostrar('datoincorrecto')
                ocultar('datosfaltan')
            }, 3000);
        }
    
    }


